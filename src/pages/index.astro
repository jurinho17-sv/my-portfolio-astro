---
import { getCollection } from 'astro:content'
import { defaultLocale } from '@/config'
import Layout from '@/layouts/Layout.astro'

const lang = defaultLocale

// Get featured projects
const projects = await getCollection('projects', ({ data }) => {
  return !data.draft && data.featured && (data.lang === lang || data.lang === '')
})

// Get recent blog posts
const posts = await getCollection('posts', ({ data }) => {
  return !data.draft && (data.lang === lang || data.lang === '')
})
const recentPosts = posts
  .sort((a, b) => b.data.published.getTime() - a.data.published.getTime())
  .slice(0, 3)

const sortedProjects = projects
  .sort((a, b) => b.data.published.getTime() - a.data.published.getTime())
  .slice(0, 2)
---

<Layout>
  <main class="main-container">
    <!-- Hero Section -->
    <section class="hero-section mb-16">
      <div class="text-center max-w-4xl mx-auto">
        <h1 class="text-5xl md:text-6xl lg:text-7xl font-bold text-primary mb-6 leading-tight">
          Hi, I'm <span class="bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">Ju Ho Kim</span>
        </h1>
        <p class="text-xl md:text-2xl text-secondary mb-8 leading-relaxed max-w-3xl mx-auto">
          Statistics (CDSS) @ UC Berkeley
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
          <a 
            href="/projects/" 
            class="inline-flex items-center gap-3 bg-[#003262] text-white px-8 py-4 rounded-lg font-medium hover:bg-[#FDB515] hover:text-[#003262] transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
            </svg>
            View My Projects
          </a>
          <a 
            href="/resume/" 
            class="inline-flex items-center gap-3 text-primary hover:text-primary/80 transition-colors font-medium group"
          >
            View Resume
            <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </a>
        </div>
      </div>
    </section>



    <!-- Featured Projects -->
    {sortedProjects.length > 0 && (
      <section class="mb-16">
        <div class="flex items-center justify-between mb-8">
          <h2 class="text-3xl font-bold text-primary">Featured Projects</h2>
          <a 
            href="/projects/" 
            class="text-primary hover:text-primary/80 transition-colors font-medium"
          >
            View All Projects ‚Üí
          </a>
        </div>
        <div class="grid md:grid-cols-2 gap-8">
          {sortedProjects.map((project) => (
            <article class="bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-xl transition-all duration-300 overflow-hidden border border-gray-200 dark:border-gray-700 group">
              <div class="aspect-video bg-gradient-to-br from-blue-100 to-indigo-200 dark:from-gray-700 dark:to-gray-600 flex items-center justify-center">
                <div class="text-4xl text-gray-400 dark:text-gray-500">üìÅ</div>
              </div>
              <div class="p-6">
                <h3 class="text-xl font-bold text-primary mb-3 group-hover:text-blue-600 transition-colors">
                  <a href={`/projects/${project.id}/`} class="stretched-link">
                    {project.data.title}
                  </a>
                </h3>
                <p class="text-secondary text-sm leading-relaxed mb-4 line-clamp-2">
                  {project.data.description}
                </p>
                {project.data.technologies && (
                  <div class="flex flex-wrap gap-2 mb-4">
                    {project.data.technologies.slice(0, 3).map((tech) => (
                      <span class="bg-[#003262]/10 dark:bg-[#1E5A96]/30 text-[#003262] dark:text-[#1E5A96] px-2 py-1 text-xs rounded-md font-medium">
                        {tech}
                      </span>
                    ))}
                  </div>
                )}
                <div class="flex gap-3">
                  {project.data.github && (
                    <a 
                      href={project.data.github} 
                      target="_blank" 
                      rel="noopener noreferrer"
                      class="text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-primary transition-colors relative z-10"
                    >
                      GitHub ‚Üí
                    </a>
                  )}
                </div>
              </div>
            </article>
          ))}
        </div>
      </section>
    )}

    <!-- Latest Blog Posts -->
    {recentPosts.length > 0 && (
      <section class="mb-16">
        <div class="flex items-center justify-between mb-8">
          <h2 class="text-3xl font-bold text-primary">Latest Blog Posts</h2>
          <a 
            href="/blog/" 
            class="text-primary hover:text-primary/80 transition-colors font-medium"
          >
            View All Posts ‚Üí
          </a>
        </div>
        <div class="grid md:grid-cols-3 gap-6">
          {recentPosts.map((post) => (
            <article class="bg-white dark:bg-gray-800 rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow border border-gray-200 dark:border-gray-700">
              <h3 class="text-lg font-semibold text-primary mb-2 hover:text-blue-600 transition-colors">
                <a href={`/posts/${post.id}/`}>
                  {post.data.title}
                </a>
              </h3>
              <p class="text-secondary text-sm mb-4 line-clamp-2">
                {post.data.description}
              </p>
              <div class="flex items-center justify-between text-xs text-gray-500">
                <time>
                  {post.data.published.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                  })}
                </time>
                {post.data.tags && post.data.tags.length > 0 && (
                  <span class="bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded">
                    {post.data.tags[0]}
                  </span>
                )}
              </div>
            </article>
          ))}
        </div>
      </section>
    )}

    <!-- Call to Action -->
    <section class="text-center bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-700 rounded-lg p-12">
      <h2 class="text-3xl font-bold text-primary mb-4">
        Let's Work Together
      </h2>
      <p class="text-secondary text-lg mb-8 max-w-2xl mx-auto leading-relaxed">
        I'm actively seeking internship opportunities and entry-level positions in Silicon Valley. 
        Let's connect and discuss how I can contribute to your team.
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a 
          href="/contact/" 
          class="inline-flex items-center gap-3 bg-[#003262] text-white px-8 py-4 rounded-lg font-medium hover:bg-[#FDB515] hover:text-[#003262] transition-all duration-300 shadow-lg hover:shadow-xl"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
          </svg>
          Get In Touch
        </a>
        <a 
          href="https://www.linkedin.com/in/justinkim-sv/" 
          target="_blank" 
          rel="noopener noreferrer"
          class="inline-flex items-center gap-3 text-primary hover:text-primary/80 transition-colors font-medium"
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
          </svg>
          Connect on LinkedIn
        </a>
      </div>
    </section>
  </main>
</Layout>

<style>
.main-container {
  max-width: 6xl;
  margin: 0 auto;
  padding: 2rem 1rem;
}

.hero-section {
  padding: 4rem 0;
}

.stretched-link::after {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1;
  content: '';
}

.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Ensure interactive elements are above the stretched link */
article a:not(.stretched-link) {
  position: relative;
  z-index: 10;
}
</style>
